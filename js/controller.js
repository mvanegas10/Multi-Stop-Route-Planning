(function(){
  var home = angular.module('demo',[]);

  home.controller('selectorController', ['$scope', function($scope) {
    var _this = this;    
    $scope.pointsSale = { "type": "FeatureCollection","features": [{ "type" : "Feature", "properties" : { "id" : 1, "name" : "Market Santa Bárbara", "address" : "Carrera 23 # 124 – 87 Interior 2, Locales 6-7 ", "hourrange" : "L-S: 8:30am - 8:00pm - D: 10:00am - 6:00pm", "observation" : null }, "geometry" : { "type" : "Point", "coordinates" : [-74.0529797, 4.7050327] } }, { "type" : "Feature", "properties" : { "id" : 2, "name" : "Market Metro 127", "address" : "Cra 15 # 127 – 73 Local 101 ", "hourrange" : "L-S: 8:30am - 8:00pm - D: 10:00am - 6:00pm", "observation" : null }, "geometry" : { "type" : "Point", "coordinates" : [-74.0428678, 4.7035639] } }, { "type" : "Feature", "properties" : { "id" : 3, "name" : "Market Cedritos", "address" : "Calle 140 # 11 - 21 ", "hourrange" : "L-S: 8:30am - 8:00pm - D: 10:00am - 6:00pm", "observation" : null }, "geometry" : { "type" : "Point", "coordinates" : [-74.0355668, 4.7189937] } }, { "type" : "Feature", "properties" : { "id" : 4, "name" : "Market Colina", "address" : "Calle 138 # 57 – 45 ", "hourrange" : "L-S: 8:30am - 8:00pm - D: 10:00am - 6:00pm", "observation" : null }, "geometry" : { "type" : "Point", "coordinates" : [-74.0634733, 4.7277972] } }, { "type" : "Feature", "properties" : { "id" : 5, "name" : "Postres CC Salitre Plaza", "address" : "Plazoleta del Sol", "hourrange" : "L-D: 7:00am - 9:00pm", "observation" : "Punto de ubicación entrada vehicular al CC" }, "geometry" : { "type" : "Point", "coordinates" : [-74.1091705, 4.6531874] } }, { "type" : "Feature", "properties" : { "id" : 6, "name" : "Postres CC Plaza de Las Américas", "address" : "Plaza Mariposas", "hourrange" : " L-V: 8:00am - 8:00pm - S y D: 8:00am - 9:00pm", "observation" : "Punto de ubicación entrada vehicular al CC (Entrada 4)" }, "geometry" : { "type" : "Point", "coordinates" : [-74.1335348, 4.6177893] } }, { "type" : "Feature", "properties" : { "id" : 7, "name" : "Postres CC Gran Estación", "address" : "Sótano 1 junto al Parqueadero", "hourrange" : "L-S: 8:00am - 9:00pm - D: 9:00am - 8:00pm", "observation" : "Punto de ubicación entrada vehicular al CC" }, "geometry" : { "type" : "Point", "coordinates" : [-74.1023379, 4.6470224] } }, { "type" : "Feature", "properties" : { "id" : 8, "name" : "Market Active Kids", "address" : "Cra 10 # 85 -24", "hourrange" : "L-V: 9:00am -7:00pm - S: 8:00am - 5:00pm", "observation" : null }, "geometry" : { "type" : "Point", "coordinates" : [-74.0501335, 4.6674313] } }, { "type" : "Feature", "properties" : { "id" : 9, "name" : "Postres CC Hayuelos", "address" : "Piso 1 – Entrada 3", "hourrange" : " L-D: 8:00am - 8:00pm", "observation" : null }, "geometry" : { "type" : "Point", "coordinates" : [-74.130989, 4.6629866] } }, { "type" : "Feature", "properties" : { "id" : 10, "name" : "Postres CC Bazaar Alsacia", "address" : "Avenida Boyacá # 12 B Local 1-02", "hourrange" : "L-D: 8:00am - 8:00pm", "observation" : "Punto de ubicación entrada vehicular " }, "geometry" : { "type" : "Point", "coordinates" : [-74.1293664, 4.6451354] } }, { "type" : "Feature", "properties" : { "id" : 11, "name" : "Postres CC Calima", "address" : "Piso 3 – Plazoleta de Comidas", "hourrange" : "L-D: 8:00am - 9:00pm", "observation" : "Punto de ubicación entrada vehicular al CC" }, "geometry" : { "type" : "Point", "coordinates" : [-74.0861083, 4.6198069] } }, { "type" : "Feature", "properties" : { "id" : 12, "name" : "Market Modelia", "address" : "Cra 90 # 23J - 22 Centro Empresarial Buro 24 ", "hourrange" : "L-S: 6:30am - 8:00pm - D: 9:00am - 7:00pm", "observation" : "Entrada vehicular al CE" }, "geometry" : { "type" : "Point", "coordinates" : [-74.1267812, 4.6732457] } }, { "type" : "Feature", "properties" : { "id" : 13, "name" : "Centro Comercial Tunal", "address" : "Calle 47 B sur # 24 B - 33", "hourrange" : "S.I.", "observation" : "Punto de ubicación entrada vehicular al CC" }, "geometry" : { "type" : "Point", "coordinates" : [-74.1310933, 4.5778696] } }, { "type" : "Feature", "properties" : { "id" : 14, "name" : "Centro Comercial Avenida Chile", "address" : "Calle 72 # 10 - 34", "hourrange" : "S.I.", "observation" : "Punto de ubicación entrada vehicular al CC" }, "geometry" : { "type" : "Point", "coordinates" : [-74.0572088, 4.657211] } }, { "type" : "Feature", "properties" : { "id" : 15, "name" : "Viva Fontibón", "address" : "Diagonal 16 # 104 - 51", "hourrange" : "S.I.", "observation" : "Punto de ubicación entrada vehicular al CC" }, "geometry" : { "type" : "Point", "coordinates" : [-74.1527379, 4.6703584] } }, { "type" : "Feature", "properties" : { "id" : 16, "name" : "Éxito Floresta", "address" : "Avenida 68 # 95 - 88", "hourrange" : "S.I.", "observation" : "Punto de ubicación entrada vehicular al CC" }, "geometry" : { "type" : "Point", "coordinates" : [-74.0757035, 4.6864829] } }, { "type" : "Feature", "properties" : { "id" : 17, "name" : "Éxito Américas", "address" : "Avenida Américas # 68 A - 94", "hourrange" : "S.I.", "observation" : "Punto de ubicación entrada vehicular al CC" }, "geometry" : { "type" : "Point", "coordinates" : [-74.1230601, 4.6305852] } }, { "type" : "Feature", "properties" : { "id" : 18, "name" : "Éxito Occidente", "address" : "Carrera 59 A # 79 - 30", "hourrange" : "S.I.", "observation" : null }, "geometry" : { "type" : "Point", "coordinates" : [-74.1242244, 4.7214454] } }, { "type" : "Feature", "properties" : { "id" : 19, "name" : "Market Usaquén", "address" : "Carrera 6 # 118 - 33", "hourrange" : "L-S: 7:00am - 10:00pm - D: 8:00am - 8:00pm", "observation" : null }, "geometry" : { "type" : "Point", "coordinates" : [-74.0312297, 4.6953712] } }, { "type" : "Feature", "properties" : { "id" : 20, "name" : "Market Nogal", "address" : "Carrera 9 # 77 - 67 ", "hourrange" : "L-S: 6:00am - 9:00pm - D: 6:00am - 6:00pm", "observation" : null }, "geometry" : { "type" : "Point", "coordinates" : [-74.0535821, 4.6616737] } }, { "type" : "Feature", "properties" : { "id" : 21, "name" : "Postres CC Diverplaza", "address" : "Transversal 96 # 70 A - 85", "hourrange" : "S.I.", "observation" : "Punto de ubicación entrada vehicular al CC" }, "geometry" : { "type" : "Point", "coordinates" : [-74.115632, 4.700334] } }] };
    $scope.pointsToAdd = [];
    _this.addPoint = addPoint;

    function addPoint(point) {
      if ($scope.pointsToAdd.length <= 6){
        var found = false;
        for (var i = 0; i < $scope.pointsToAdd.length; i++) {
          var id = $scope.pointsToAdd[i].properties.id;
          found = (id === point.properties.id);
          if(found) break;
        };
        if(!found) {
          $scope.pointsToAdd.push(point);
          addPointToMap(point);
        }
      } 
      else alert("No es posible agregar más de 6 paradas.")
    }

    $scope.getBestRoute = function () {
      // $.ajax({
      //   type: 'GET',
      //   url: 'http://181.60.255.206:8084/LogisticRouteService/computeDistributionRoute?distributionPoints=1,2',
      //   dataType: 'json',
      //   success: function (data) {
      //     // Get data of optimal routes  
      //     var data = { "type": "FeatureCollection","features": [{"type":"Feature","properties":{"totalTime":2452.151,"totalDistance":{"distanceUnit":"M","value":36130.234},"bbox":[-74.053,4.704529,-73.94186,4.94186]},"geometry":{"type":"LineString","coordinates":[[-73.94186,4.911369],[-73.94186,4.911122],[-73.94192,4.910591],[-73.94194,4.910498],[-73.94218,4.909479],[-73.942986,4.909702],[-73.9431,4.909727],[-73.94309,4.909993],[-73.94291,4.911969],[-73.94288,4.912204],[-73.94265,4.913097],[-73.942505,4.913497],[-73.9423,4.913506],[-73.94212,4.913643],[-73.94216,4.913836],[-73.94228,4.913934],[-73.94251,4.914005],[-73.94348,4.915144],[-73.944534,4.915914],[-73.94537,4.91694],[-73.9464,4.918761],[-73.947365,4.919728],[-73.94775,4.920172],[-73.94818,4.920874],[-73.94887,4.92184],[-73.95052,4.923935],[-73.95152,4.92532],[-73.95183,4.925842],[-73.95209,4.927159],[-73.95217,4.927826],[-73.9522,4.929023],[-73.95227,4.930135],[-73.95238,4.930862],[-73.95243,4.931075],[-73.95296,4.931717],[-73.95672,4.935992],[-73.95824,4.937763],[-73.95908,4.938617],[-73.95961,4.939224],[-73.96051,4.940319],[-73.9611,4.941116],[-73.96166,4.94186],[-73.963234,4.941116],[-73.96416,4.940656],[-73.96557,4.940073],[-73.96649,4.939761],[-73.96719,4.939582],[-73.967995,4.939496],[-73.96972,4.939491],[-73.97086,4.939346],[-73.97254,4.939171],[-73.974266,4.939047],[-73.97654,4.938744],[-73.978775,4.938397],[-73.981,4.937781],[-73.98519,4.936285],[-73.987015,4.935558],[-73.988045,4.934959],[-73.98901,4.934361],[-73.99213,4.931338],[-73.99352,4.929801],[-73.99478,4.92821],[-73.9952,4.927729],[-73.99614,4.926365],[-73.996574,4.92567],[-73.99685,4.925124],[-73.99708,4.924298],[-73.99732,4.922558],[-73.99907,4.917198],[-74.00094,4.911742],[-74.00145,4.910117],[-74.00241,4.907526],[-74.00344,4.905174],[-74.00708,4.897829],[-74.00914,4.893749],[-74.01156,4.889739],[-74.01407,4.88587],[-74.015335,4.883808],[-74.0184,4.878972],[-74.019875,4.877465],[-74.02054,4.876695],[-74.02108,4.875848],[-74.02154,4.874439],[-74.02198,4.872831],[-74.02302,4.869753],[-74.02457,4.865879],[-74.02494,4.865336],[-74.025246,4.865023],[-74.02556,4.864834],[-74.02629,4.864446],[-74.02673,4.864277],[-74.02714,4.864029],[-74.02741,4.863819],[-74.02778,4.863387],[-74.027954,4.863101],[-74.0281,4.862778],[-74.028206,4.86239],[-74.028404,4.861217],[-74.0287,4.859823],[-74.02883,4.859065],[-74.02922,4.856804],[-74.02928,4.856361],[-74.02944,4.855461],[-74.02958,4.854939],[-74.0299,4.853808],[-74.03008,4.853025],[-74.030174,4.852547],[-74.03105,4.846714],[-74.03115,4.846196],[-74.03237,4.838451],[-74.03291,4.835338],[-74.03324,4.83332],[-74.033516,4.831507],[-74.03383,4.829807],[-74.03407,4.828256],[-74.03423,4.827627],[-74.03503,4.824841],[-74.03522,4.823945],[-74.03533,4.82317],[-74.0354,4.82252],[-74.03546,4.820594],[-74.03561,4.819182],[-74.03586,4.817479],[-74.037125,4.809455],[-74.03749,4.806943],[-74.03842,4.801642],[-74.03974,4.793868],[-74.040054,4.791667],[-74.04045,4.788805],[-74.0411,4.785214],[-74.04118,4.784841],[-74.04129,4.784097],[-74.04144,4.783448],[-74.04175,4.78189],[-74.04183,4.780994],[-74.04188,4.780297],[-74.042,4.779373],[-74.04231,4.777655],[-74.0427,4.775993],[-74.0428,4.775469],[-74.04284,4.775111],[-74.04401,4.767964],[-74.04405,4.767419],[-74.044136,4.766874],[-74.04454,4.764821],[-74.044876,4.762774],[-74.0451,4.761214],[-74.04545,4.759733],[-74.04554,4.759499],[-74.04572,4.75851],[-74.04596,4.757388],[-74.04627,4.755515],[-74.04639,4.755081],[-74.046486,4.754583],[-74.04661,4.754347],[-74.04672,4.753433],[-74.04664,4.752365],[-74.04689,4.7512],[-74.04693,4.750859],[-74.04696,4.749921],[-74.04705,4.748363],[-74.04744,4.746186],[-74.04753,4.74553],[-74.04781,4.743819],[-74.047935,4.742929],[-74.04932,4.734856],[-74.04977,4.732097],[-74.04993,4.731288],[-74.05043,4.728216],[-74.05089,4.725177],[-74.05144,4.722058],[-74.0516,4.721639],[-74.05179,4.721038],[-74.05181,4.720902],[-74.05193,4.720211],[-74.05194,4.71951],[-74.05201,4.719008],[-74.05204,4.718775],[-74.05224,4.718391],[-74.052284,4.71835],[-74.05239,4.718286],[-74.05258,4.718304],[-74.053,4.718655],[-74.05298,4.718902],[-74.05286,4.719036],[-74.05265,4.719014],[-74.05114,4.718847],[-74.05032,4.718717],[-74.049805,4.718534],[-74.04962,4.718451],[-74.04878,4.71817],[-74.04809,4.71792],[-74.047264,4.717609],[-74.0474,4.716788],[-74.04759,4.715369],[-74.047745,4.714512],[-74.0482,4.711547],[-74.04867,4.707514],[-74.04872,4.706582],[-74.0489,4.705311],[-74.048996,4.704529],[-74.051094,4.704908],[-74.05293,4.705216],[-74.05296,4.70503]]},"routeInstructionsList":{"lang":"ES","routeInstruction":[{"instruction":"ContinÃºe","duration":"8.947","manuverType":"START","geometry":{"type":"LineString","coordinates":[[-73.94186,4.911369],[-73.94186,4.911122]]}},{"instruction":"ContinÃºe por Carrera 5","duration":"22.854","manuverType":"KEEP","geometry":{"type":"LineString","coordinates":[[-73.94192,4.910591],[-73.94194,4.910498]]}},{"instruction":"Gire a la derecha por Calle 3B","duration":"19.051","manuverType":"RTURN","geometry":{"type":"LineString","coordinates":[[-73.94218,4.909479],[-73.942986,4.909702]]}},{"instruction":"Gire a la derecha","duration":"44.324","manuverType":"RTURN","geometry":{"type":"LineString","coordinates":[[-73.9431,4.909727],[-73.94309,4.909993],[-73.94291,4.911969],[-73.94288,4.912204],[-73.94265,4.913097],[-73.942505,4.913497],[-73.9423,4.913506],[-73.94212,4.913643],[-73.94216,4.913836],[-73.94228,4.913934]]}},{"instruction":"Gire leve a la derecha por Via a Sopo","duration":"166.852","manuverType":"SFT_RTURN","geometry":{"type":"LineString","coordinates":[[-73.94251,4.914005],[-73.94348,4.915144],[-73.944534,4.915914],[-73.94537,4.91694],[-73.9464,4.918761],[-73.947365,4.919728],[-73.94775,4.920172],[-73.94818,4.920874],[-73.94887,4.92184],[-73.95052,4.923935],[-73.95152,4.92532],[-73.95183,4.925842],[-73.95209,4.927159],[-73.95217,4.927826],[-73.9522,4.929023],[-73.95227,4.930135],[-73.95238,4.930862],[-73.95243,4.931075],[-73.95296,4.931717],[-73.95672,4.935992],[-73.95824,4.937763],[-73.95908,4.938617]]}},{"instruction":"ContinÃºe","duration":"14.169","manuverType":"KEEP","geometry":{"type":"LineString","coordinates":[[-73.95961,4.939224]]}},{"instruction":"ContinÃºe por Calle 7","duration":"19.226","manuverType":"KEEP","geometry":{"type":"LineString","coordinates":[[-73.96051,4.940319],[-73.9611,4.941116]]}},{"instruction":"Gire a la izquierda","duration":"67.86","manuverType":"LTURN","geometry":{"type":"LineString","coordinates":[[-73.96166,4.94186],[-73.963234,4.941116],[-73.96416,4.940656],[-73.96557,4.940073],[-73.96649,4.939761],[-73.96719,4.939582]]}},{"instruction":"Gire leve a la izquierda por Autopista Norte","duration":"585.483","manuverType":"SFT_LTURN","geometry":{"type":"LineString","coordinates":[[-73.967995,4.939496],[-73.96972,4.939491],[-73.97086,4.939346],[-73.97254,4.939171],[-73.974266,4.939047],[-73.97654,4.938744],[-73.978775,4.938397],[-73.981,4.937781],[-73.98519,4.936285],[-73.987015,4.935558],[-73.988045,4.934959],[-73.98901,4.934361],[-73.99213,4.931338],[-73.99352,4.929801],[-73.99478,4.92821],[-73.9952,4.927729],[-73.99614,4.926365],[-73.996574,4.92567],[-73.99685,4.925124],[-73.99708,4.924298],[-73.99732,4.922558],[-73.99907,4.917198],[-74.00094,4.911742],[-74.00145,4.910117],[-74.00241,4.907526],[-74.00344,4.905174],[-74.00708,4.897829],[-74.00914,4.893749],[-74.01156,4.889739],[-74.01407,4.88587],[-74.015335,4.883808],[-74.0184,4.878972],[-74.019875,4.877465],[-74.02054,4.876695],[-74.02108,4.875848],[-74.02154,4.874439],[-74.02198,4.872831],[-74.02302,4.869753],[-74.02457,4.865879],[-74.02494,4.865336],[-74.025246,4.865023],[-74.02556,4.864834],[-74.02629,4.864446],[-74.02673,4.864277],[-74.02714,4.864029],[-74.02741,4.863819],[-74.02778,4.863387],[-74.027954,4.863101],[-74.0281,4.862778]]}},{"instruction":"ContinÃºe por Autopista Norte, Carrera 45, Avenida Paseo Los Libertadores","duration":"543.305","manuverType":"KEEP","geometry":{"type":"LineString","coordinates":[[-74.028206,4.86239],[-74.028404,4.861217],[-74.0287,4.859823],[-74.02883,4.859065],[-74.02922,4.856804],[-74.02928,4.856361],[-74.02944,4.855461],[-74.02958,4.854939],[-74.0299,4.853808],[-74.03008,4.853025],[-74.030174,4.852547],[-74.03105,4.846714],[-74.03115,4.846196],[-74.03237,4.838451],[-74.03291,4.835338],[-74.03324,4.83332],[-74.033516,4.831507],[-74.03383,4.829807],[-74.03407,4.828256],[-74.03423,4.827627],[-74.03503,4.824841],[-74.03522,4.823945],[-74.03533,4.82317],[-74.0354,4.82252],[-74.03546,4.820594],[-74.03561,4.819182],[-74.03586,4.817479],[-74.037125,4.809455],[-74.03749,4.806943],[-74.03842,4.801642],[-74.03974,4.793868],[-74.040054,4.791667]]}},{"instruction":"ContinÃºe por Autopista Norte avenida paseo los libertadores- Carrera 45","duration":"615.782","manuverType":"KEEP","geometry":{"type":"LineString","coordinates":[[-74.04045,4.788805],[-74.0411,4.785214],[-74.04118,4.784841],[-74.04129,4.784097],[-74.04144,4.783448],[-74.04175,4.78189],[-74.04183,4.780994],[-74.04188,4.780297],[-74.042,4.779373],[-74.04231,4.777655],[-74.0427,4.775993],[-74.0428,4.775469],[-74.04284,4.775111],[-74.04401,4.767964],[-74.04405,4.767419],[-74.044136,4.766874],[-74.04454,4.764821],[-74.044876,4.762774],[-74.0451,4.761214],[-74.04545,4.759733],[-74.04554,4.759499],[-74.04572,4.75851],[-74.04596,4.757388],[-74.04627,4.755515],[-74.04639,4.755081],[-74.046486,4.754583],[-74.04661,4.754347],[-74.04672,4.753433],[-74.04664,4.752365],[-74.04689,4.7512],[-74.04693,4.750859],[-74.04696,4.749921],[-74.04705,4.748363],[-74.04744,4.746186],[-74.04753,4.74553],[-74.04781,4.743819],[-74.047935,4.742929],[-74.04932,4.734856],[-74.04977,4.732097],[-74.04993,4.731288],[-74.05043,4.728216],[-74.05089,4.725177]]}},{"instruction":"ContinÃºe","duration":"10.786","manuverType":"KEEP","geometry":{"type":"LineString","coordinates":[[-74.05144,4.722058],[-74.0516,4.721639]]}},{"instruction":"ContinÃºe por Autopista Norte - Paralela Occ.","duration":"12.464","manuverType":"KEEP","geometry":{"type":"LineString","coordinates":[[-74.05179,4.721038],[-74.05181,4.720902]]}},{"instruction":"ContinÃºe por Autopista Norte - Paralela Occidental","duration":"18.952","manuverType":"KEEP","geometry":{"type":"LineString","coordinates":[[-74.05193,4.720211],[-74.05194,4.71951],[-74.05201,4.719008]]}},{"instruction":"Gire leve a la derecha por Rampa calle 134 oriente","duration":"17.805","manuverType":"SFT_RTURN","geometry":{"type":"LineString","coordinates":[[-74.05204,4.718775],[-74.05224,4.718391],[-74.052284,4.71835],[-74.05239,4.718286],[-74.05258,4.718304],[-74.053,4.718655],[-74.05298,4.718902]]}},{"instruction":"Gire a la derecha por Avenida Iberia, Calle 134","duration":"25.497","manuverType":"RTURN","geometry":{"type":"LineString","coordinates":[[-74.05286,4.719036],[-74.05265,4.719014]]}},{"instruction":"ContinÃºe por Avenida Contador, Calle 134","duration":"49.377","manuverType":"KEEP","geometry":{"type":"LineString","coordinates":[[-74.05114,4.718847],[-74.05032,4.718717],[-74.049805,4.718534],[-74.04962,4.718451],[-74.04878,4.71817],[-74.04809,4.71792]]}},{"instruction":"Gire a la derecha por Avenida Santa BÃ¡rbara - Carrera 19","duration":"160.105","manuverType":"RTURN","geometry":{"type":"LineString","coordinates":[[-74.047264,4.717609],[-74.0474,4.716788],[-74.04759,4.715369],[-74.047745,4.714512],[-74.0482,4.711547],[-74.04867,4.707514],[-74.04872,4.706582],[-74.0489,4.705311]]}},{"instruction":"Gire a la derecha por Calle 125","duration":"45.533","manuverType":"RTURN","geometry":{"type":"LineString","coordinates":[[-74.048996,4.704529],[-74.051094,4.704908]]}},{"instruction":"Gire a la izquierda por Carrera 23","duration":"3.779","manuverType":"LTURN","geometry":{"type":"LineString","coordinates":[[-74.05293,4.705216]]}},{"instruction":"Â¡Fin del recorrido!","duration":"0.0","manuverType":"END","geometry":{"type":"LineString","coordinates":[]}}]}}, {"type":"Feature","properties":{"totalTime":160.926,"totalDistance":{"distanceUnit":"M","value":1286.935},"bbox":[-74.05296,4.703565,-74.04286,4.705318]},"geometry":{"type":"LineString","coordinates":[[-74.05296,4.70503],[-74.05293,4.705216],[-74.051094,4.704908],[-74.04891,4.704519],[-74.04887,4.704511],[-74.04872,4.705262],[-74.04871,4.705318],[-74.04696,4.704814],[-74.045654,4.704384],[-74.04461,4.70418],[-74.043564,4.704061],[-74.04286,4.704018],[-74.04287,4.70393],[-74.042885,4.703565]]},"routeInstructionsList":{"lang":"ES","routeInstruction":[{"instruction":"ContinÃºe por Carrera 23","duration":"3.779","manuverType":"START","geometry":{"type":"LineString","coordinates":[[-74.05296,4.70503]]}},{"instruction":"Gire a la derecha por Calle 125","duration":"47.029","manuverType":"RTURN","geometry":{"type":"LineString","coordinates":[[-74.05293,4.705216],[-74.051094,4.704908],[-74.04891,4.704519]]}},{"instruction":"Gire a la izquierda por Avenida Santa BÃ¡rbara - Carrera 19","duration":"10.305","manuverType":"LTURN","geometry":{"type":"LineString","coordinates":[[-74.04887,4.704511],[-74.04872,4.705262]]}},{"instruction":"Gire a la derecha por Avenida Callejas - Calle 127","duration":"91.974","manuverType":"RTURN","geometry":{"type":"LineString","coordinates":[[-74.04871,4.705318],[-74.04696,4.704814],[-74.045654,4.704384],[-74.04461,4.70418],[-74.043564,4.704061]]}},{"instruction":"Gire a la derecha por Avenida Carrera 15","duration":"7.839","manuverType":"RTURN","geometry":{"type":"LineString","coordinates":[[-74.04286,4.704018],[-74.04287,4.70393]]}},{"instruction":"Â¡Fin del recorrido!","duration":"0.0","manuverType":"END","geometry":{"type":"LineString","coordinates":[]}}]}}] };   
      //     console.log(data);
      //     addLines(data);
      //   }
      // });
      var data = { "type": "FeatureCollection","features": [{"type":"Feature","properties":{"totalTime":2452.151,"totalDistance":{"distanceUnit":"M","value":36130.234},"bbox":[-74.053,4.704529,-73.94186,4.94186]},"geometry":{"type":"LineString","coordinates":[[-73.94186,4.911369],[-73.94186,4.911122],[-73.94192,4.910591],[-73.94194,4.910498],[-73.94218,4.909479],[-73.942986,4.909702],[-73.9431,4.909727],[-73.94309,4.909993],[-73.94291,4.911969],[-73.94288,4.912204],[-73.94265,4.913097],[-73.942505,4.913497],[-73.9423,4.913506],[-73.94212,4.913643],[-73.94216,4.913836],[-73.94228,4.913934],[-73.94251,4.914005],[-73.94348,4.915144],[-73.944534,4.915914],[-73.94537,4.91694],[-73.9464,4.918761],[-73.947365,4.919728],[-73.94775,4.920172],[-73.94818,4.920874],[-73.94887,4.92184],[-73.95052,4.923935],[-73.95152,4.92532],[-73.95183,4.925842],[-73.95209,4.927159],[-73.95217,4.927826],[-73.9522,4.929023],[-73.95227,4.930135],[-73.95238,4.930862],[-73.95243,4.931075],[-73.95296,4.931717],[-73.95672,4.935992],[-73.95824,4.937763],[-73.95908,4.938617],[-73.95961,4.939224],[-73.96051,4.940319],[-73.9611,4.941116],[-73.96166,4.94186],[-73.963234,4.941116],[-73.96416,4.940656],[-73.96557,4.940073],[-73.96649,4.939761],[-73.96719,4.939582],[-73.967995,4.939496],[-73.96972,4.939491],[-73.97086,4.939346],[-73.97254,4.939171],[-73.974266,4.939047],[-73.97654,4.938744],[-73.978775,4.938397],[-73.981,4.937781],[-73.98519,4.936285],[-73.987015,4.935558],[-73.988045,4.934959],[-73.98901,4.934361],[-73.99213,4.931338],[-73.99352,4.929801],[-73.99478,4.92821],[-73.9952,4.927729],[-73.99614,4.926365],[-73.996574,4.92567],[-73.99685,4.925124],[-73.99708,4.924298],[-73.99732,4.922558],[-73.99907,4.917198],[-74.00094,4.911742],[-74.00145,4.910117],[-74.00241,4.907526],[-74.00344,4.905174],[-74.00708,4.897829],[-74.00914,4.893749],[-74.01156,4.889739],[-74.01407,4.88587],[-74.015335,4.883808],[-74.0184,4.878972],[-74.019875,4.877465],[-74.02054,4.876695],[-74.02108,4.875848],[-74.02154,4.874439],[-74.02198,4.872831],[-74.02302,4.869753],[-74.02457,4.865879],[-74.02494,4.865336],[-74.025246,4.865023],[-74.02556,4.864834],[-74.02629,4.864446],[-74.02673,4.864277],[-74.02714,4.864029],[-74.02741,4.863819],[-74.02778,4.863387],[-74.027954,4.863101],[-74.0281,4.862778],[-74.028206,4.86239],[-74.028404,4.861217],[-74.0287,4.859823],[-74.02883,4.859065],[-74.02922,4.856804],[-74.02928,4.856361],[-74.02944,4.855461],[-74.02958,4.854939],[-74.0299,4.853808],[-74.03008,4.853025],[-74.030174,4.852547],[-74.03105,4.846714],[-74.03115,4.846196],[-74.03237,4.838451],[-74.03291,4.835338],[-74.03324,4.83332],[-74.033516,4.831507],[-74.03383,4.829807],[-74.03407,4.828256],[-74.03423,4.827627],[-74.03503,4.824841],[-74.03522,4.823945],[-74.03533,4.82317],[-74.0354,4.82252],[-74.03546,4.820594],[-74.03561,4.819182],[-74.03586,4.817479],[-74.037125,4.809455],[-74.03749,4.806943],[-74.03842,4.801642],[-74.03974,4.793868],[-74.040054,4.791667],[-74.04045,4.788805],[-74.0411,4.785214],[-74.04118,4.784841],[-74.04129,4.784097],[-74.04144,4.783448],[-74.04175,4.78189],[-74.04183,4.780994],[-74.04188,4.780297],[-74.042,4.779373],[-74.04231,4.777655],[-74.0427,4.775993],[-74.0428,4.775469],[-74.04284,4.775111],[-74.04401,4.767964],[-74.04405,4.767419],[-74.044136,4.766874],[-74.04454,4.764821],[-74.044876,4.762774],[-74.0451,4.761214],[-74.04545,4.759733],[-74.04554,4.759499],[-74.04572,4.75851],[-74.04596,4.757388],[-74.04627,4.755515],[-74.04639,4.755081],[-74.046486,4.754583],[-74.04661,4.754347],[-74.04672,4.753433],[-74.04664,4.752365],[-74.04689,4.7512],[-74.04693,4.750859],[-74.04696,4.749921],[-74.04705,4.748363],[-74.04744,4.746186],[-74.04753,4.74553],[-74.04781,4.743819],[-74.047935,4.742929],[-74.04932,4.734856],[-74.04977,4.732097],[-74.04993,4.731288],[-74.05043,4.728216],[-74.05089,4.725177],[-74.05144,4.722058],[-74.0516,4.721639],[-74.05179,4.721038],[-74.05181,4.720902],[-74.05193,4.720211],[-74.05194,4.71951],[-74.05201,4.719008],[-74.05204,4.718775],[-74.05224,4.718391],[-74.052284,4.71835],[-74.05239,4.718286],[-74.05258,4.718304],[-74.053,4.718655],[-74.05298,4.718902],[-74.05286,4.719036],[-74.05265,4.719014],[-74.05114,4.718847],[-74.05032,4.718717],[-74.049805,4.718534],[-74.04962,4.718451],[-74.04878,4.71817],[-74.04809,4.71792],[-74.047264,4.717609],[-74.0474,4.716788],[-74.04759,4.715369],[-74.047745,4.714512],[-74.0482,4.711547],[-74.04867,4.707514],[-74.04872,4.706582],[-74.0489,4.705311],[-74.048996,4.704529],[-74.051094,4.704908],[-74.05293,4.705216],[-74.05296,4.70503]]},"routeInstructionsList":{"lang":"ES","routeInstruction":[{"instruction":"ContinÃºe","duration":"8.947","manuverType":"START","geometry":{"type":"LineString","coordinates":[[-73.94186,4.911369],[-73.94186,4.911122]]}},{"instruction":"ContinÃºe por Carrera 5","duration":"22.854","manuverType":"KEEP","geometry":{"type":"LineString","coordinates":[[-73.94192,4.910591],[-73.94194,4.910498]]}},{"instruction":"Gire a la derecha por Calle 3B","duration":"19.051","manuverType":"RTURN","geometry":{"type":"LineString","coordinates":[[-73.94218,4.909479],[-73.942986,4.909702]]}},{"instruction":"Gire a la derecha","duration":"44.324","manuverType":"RTURN","geometry":{"type":"LineString","coordinates":[[-73.9431,4.909727],[-73.94309,4.909993],[-73.94291,4.911969],[-73.94288,4.912204],[-73.94265,4.913097],[-73.942505,4.913497],[-73.9423,4.913506],[-73.94212,4.913643],[-73.94216,4.913836],[-73.94228,4.913934]]}},{"instruction":"Gire leve a la derecha por Via a Sopo","duration":"166.852","manuverType":"SFT_RTURN","geometry":{"type":"LineString","coordinates":[[-73.94251,4.914005],[-73.94348,4.915144],[-73.944534,4.915914],[-73.94537,4.91694],[-73.9464,4.918761],[-73.947365,4.919728],[-73.94775,4.920172],[-73.94818,4.920874],[-73.94887,4.92184],[-73.95052,4.923935],[-73.95152,4.92532],[-73.95183,4.925842],[-73.95209,4.927159],[-73.95217,4.927826],[-73.9522,4.929023],[-73.95227,4.930135],[-73.95238,4.930862],[-73.95243,4.931075],[-73.95296,4.931717],[-73.95672,4.935992],[-73.95824,4.937763],[-73.95908,4.938617]]}},{"instruction":"ContinÃºe","duration":"14.169","manuverType":"KEEP","geometry":{"type":"LineString","coordinates":[[-73.95961,4.939224]]}},{"instruction":"ContinÃºe por Calle 7","duration":"19.226","manuverType":"KEEP","geometry":{"type":"LineString","coordinates":[[-73.96051,4.940319],[-73.9611,4.941116]]}},{"instruction":"Gire a la izquierda","duration":"67.86","manuverType":"LTURN","geometry":{"type":"LineString","coordinates":[[-73.96166,4.94186],[-73.963234,4.941116],[-73.96416,4.940656],[-73.96557,4.940073],[-73.96649,4.939761],[-73.96719,4.939582]]}},{"instruction":"Gire leve a la izquierda por Autopista Norte","duration":"585.483","manuverType":"SFT_LTURN","geometry":{"type":"LineString","coordinates":[[-73.967995,4.939496],[-73.96972,4.939491],[-73.97086,4.939346],[-73.97254,4.939171],[-73.974266,4.939047],[-73.97654,4.938744],[-73.978775,4.938397],[-73.981,4.937781],[-73.98519,4.936285],[-73.987015,4.935558],[-73.988045,4.934959],[-73.98901,4.934361],[-73.99213,4.931338],[-73.99352,4.929801],[-73.99478,4.92821],[-73.9952,4.927729],[-73.99614,4.926365],[-73.996574,4.92567],[-73.99685,4.925124],[-73.99708,4.924298],[-73.99732,4.922558],[-73.99907,4.917198],[-74.00094,4.911742],[-74.00145,4.910117],[-74.00241,4.907526],[-74.00344,4.905174],[-74.00708,4.897829],[-74.00914,4.893749],[-74.01156,4.889739],[-74.01407,4.88587],[-74.015335,4.883808],[-74.0184,4.878972],[-74.019875,4.877465],[-74.02054,4.876695],[-74.02108,4.875848],[-74.02154,4.874439],[-74.02198,4.872831],[-74.02302,4.869753],[-74.02457,4.865879],[-74.02494,4.865336],[-74.025246,4.865023],[-74.02556,4.864834],[-74.02629,4.864446],[-74.02673,4.864277],[-74.02714,4.864029],[-74.02741,4.863819],[-74.02778,4.863387],[-74.027954,4.863101],[-74.0281,4.862778]]}},{"instruction":"ContinÃºe por Autopista Norte, Carrera 45, Avenida Paseo Los Libertadores","duration":"543.305","manuverType":"KEEP","geometry":{"type":"LineString","coordinates":[[-74.028206,4.86239],[-74.028404,4.861217],[-74.0287,4.859823],[-74.02883,4.859065],[-74.02922,4.856804],[-74.02928,4.856361],[-74.02944,4.855461],[-74.02958,4.854939],[-74.0299,4.853808],[-74.03008,4.853025],[-74.030174,4.852547],[-74.03105,4.846714],[-74.03115,4.846196],[-74.03237,4.838451],[-74.03291,4.835338],[-74.03324,4.83332],[-74.033516,4.831507],[-74.03383,4.829807],[-74.03407,4.828256],[-74.03423,4.827627],[-74.03503,4.824841],[-74.03522,4.823945],[-74.03533,4.82317],[-74.0354,4.82252],[-74.03546,4.820594],[-74.03561,4.819182],[-74.03586,4.817479],[-74.037125,4.809455],[-74.03749,4.806943],[-74.03842,4.801642],[-74.03974,4.793868],[-74.040054,4.791667]]}},{"instruction":"ContinÃºe por Autopista Norte avenida paseo los libertadores- Carrera 45","duration":"615.782","manuverType":"KEEP","geometry":{"type":"LineString","coordinates":[[-74.04045,4.788805],[-74.0411,4.785214],[-74.04118,4.784841],[-74.04129,4.784097],[-74.04144,4.783448],[-74.04175,4.78189],[-74.04183,4.780994],[-74.04188,4.780297],[-74.042,4.779373],[-74.04231,4.777655],[-74.0427,4.775993],[-74.0428,4.775469],[-74.04284,4.775111],[-74.04401,4.767964],[-74.04405,4.767419],[-74.044136,4.766874],[-74.04454,4.764821],[-74.044876,4.762774],[-74.0451,4.761214],[-74.04545,4.759733],[-74.04554,4.759499],[-74.04572,4.75851],[-74.04596,4.757388],[-74.04627,4.755515],[-74.04639,4.755081],[-74.046486,4.754583],[-74.04661,4.754347],[-74.04672,4.753433],[-74.04664,4.752365],[-74.04689,4.7512],[-74.04693,4.750859],[-74.04696,4.749921],[-74.04705,4.748363],[-74.04744,4.746186],[-74.04753,4.74553],[-74.04781,4.743819],[-74.047935,4.742929],[-74.04932,4.734856],[-74.04977,4.732097],[-74.04993,4.731288],[-74.05043,4.728216],[-74.05089,4.725177]]}},{"instruction":"ContinÃºe","duration":"10.786","manuverType":"KEEP","geometry":{"type":"LineString","coordinates":[[-74.05144,4.722058],[-74.0516,4.721639]]}},{"instruction":"ContinÃºe por Autopista Norte - Paralela Occ.","duration":"12.464","manuverType":"KEEP","geometry":{"type":"LineString","coordinates":[[-74.05179,4.721038],[-74.05181,4.720902]]}},{"instruction":"ContinÃºe por Autopista Norte - Paralela Occidental","duration":"18.952","manuverType":"KEEP","geometry":{"type":"LineString","coordinates":[[-74.05193,4.720211],[-74.05194,4.71951],[-74.05201,4.719008]]}},{"instruction":"Gire leve a la derecha por Rampa calle 134 oriente","duration":"17.805","manuverType":"SFT_RTURN","geometry":{"type":"LineString","coordinates":[[-74.05204,4.718775],[-74.05224,4.718391],[-74.052284,4.71835],[-74.05239,4.718286],[-74.05258,4.718304],[-74.053,4.718655],[-74.05298,4.718902]]}},{"instruction":"Gire a la derecha por Avenida Iberia, Calle 134","duration":"25.497","manuverType":"RTURN","geometry":{"type":"LineString","coordinates":[[-74.05286,4.719036],[-74.05265,4.719014]]}},{"instruction":"ContinÃºe por Avenida Contador, Calle 134","duration":"49.377","manuverType":"KEEP","geometry":{"type":"LineString","coordinates":[[-74.05114,4.718847],[-74.05032,4.718717],[-74.049805,4.718534],[-74.04962,4.718451],[-74.04878,4.71817],[-74.04809,4.71792]]}},{"instruction":"Gire a la derecha por Avenida Santa BÃ¡rbara - Carrera 19","duration":"160.105","manuverType":"RTURN","geometry":{"type":"LineString","coordinates":[[-74.047264,4.717609],[-74.0474,4.716788],[-74.04759,4.715369],[-74.047745,4.714512],[-74.0482,4.711547],[-74.04867,4.707514],[-74.04872,4.706582],[-74.0489,4.705311]]}},{"instruction":"Gire a la derecha por Calle 125","duration":"45.533","manuverType":"RTURN","geometry":{"type":"LineString","coordinates":[[-74.048996,4.704529],[-74.051094,4.704908]]}},{"instruction":"Gire a la izquierda por Carrera 23","duration":"3.779","manuverType":"LTURN","geometry":{"type":"LineString","coordinates":[[-74.05293,4.705216]]}},{"instruction":"Â¡Fin del recorrido!","duration":"0.0","manuverType":"END","geometry":{"type":"LineString","coordinates":[]}}]}}, {"type":"Feature","properties":{"totalTime":160.926,"totalDistance":{"distanceUnit":"M","value":1286.935},"bbox":[-74.05296,4.703565,-74.04286,4.705318]},"geometry":{"type":"LineString","coordinates":[[-74.05296,4.70503],[-74.05293,4.705216],[-74.051094,4.704908],[-74.04891,4.704519],[-74.04887,4.704511],[-74.04872,4.705262],[-74.04871,4.705318],[-74.04696,4.704814],[-74.045654,4.704384],[-74.04461,4.70418],[-74.043564,4.704061],[-74.04286,4.704018],[-74.04287,4.70393],[-74.042885,4.703565]]},"routeInstructionsList":{"lang":"ES","routeInstruction":[{"instruction":"ContinÃºe por Carrera 23","duration":"3.779","manuverType":"START","geometry":{"type":"LineString","coordinates":[[-74.05296,4.70503]]}},{"instruction":"Gire a la derecha por Calle 125","duration":"47.029","manuverType":"RTURN","geometry":{"type":"LineString","coordinates":[[-74.05293,4.705216],[-74.051094,4.704908],[-74.04891,4.704519]]}},{"instruction":"Gire a la izquierda por Avenida Santa BÃ¡rbara - Carrera 19","duration":"10.305","manuverType":"LTURN","geometry":{"type":"LineString","coordinates":[[-74.04887,4.704511],[-74.04872,4.705262]]}},{"instruction":"Gire a la derecha por Avenida Callejas - Calle 127","duration":"91.974","manuverType":"RTURN","geometry":{"type":"LineString","coordinates":[[-74.04871,4.705318],[-74.04696,4.704814],[-74.045654,4.704384],[-74.04461,4.70418],[-74.043564,4.704061]]}},{"instruction":"Gire a la derecha por Avenida Carrera 15","duration":"7.839","manuverType":"RTURN","geometry":{"type":"LineString","coordinates":[[-74.04286,4.704018],[-74.04287,4.70393]]}},{"instruction":"Â¡Fin del recorrido!","duration":"0.0","manuverType":"END","geometry":{"type":"LineString","coordinates":[]}}]}}] };   
      console.log(data.features);
      addLines(data.features);
    }

  }]);
})();

// MAP
var info = L.control();
var map; 
var colors = ["#6980ce","#76b341","#b460bd","#4fae84","#c8577b","#7c7f39","#c95c3f","#ce9b44"];

function createMap() {
  map = L.map('map').setView([4.804529, -74.053], 11); // Initial position in the map (lat, long, zoom)
  map.addLayer(new L.TileLayer.provider('Esri.WorldGrayCanvas')); // The map provider we are going to use --> You must import the corresponding library in index.html
  map._layersMaxZoom = 16; // Define the maximum zoom in the map
  map._layersMinZoom = 10;

  L.control.scale({ // Manage the scale:
      position: 'bottomleft', // .. where is it located
      imperial: false // .. use the metric system (default is imperial)
  }).addTo(map);

  info.addTo(map); // Here we add the info DIV to the map itself
}

function addPointToMap(point) {
  console.log(point);
  L.geoJson(point).addTo(map);
}

function addLines(featureCollection) {
  var i = 0;
  featureCollection.forEach(function(d){
    console.log(d)
    d.properties.Id = i;
    i = i + 1;
  });
  L.geoJson(featureCollection, {
    style: function (feature) {
      console.log(feature);
      return {"color": colors[feature.properties.Id],"weight": 5,"opacity": 0.65};
    },
    onEachFeature: function (feature, layer) {
      layer.on({
        mouseover: function() { // Here we are going to change the color and show the attributes of the object that is under the mouse...
          info.update(feature.properties); // --> Update the info <div>
        },
        mouseout: function() { // When the mouse leaves...
          info.update(); // --> Clear the info <div>
        },
      });
    }
  }).addTo(map);
}

// This function creates the DIV to display the additional attributes of the selected spatial object
info.onAdd = function(map) {
  this._div = L.DomUtil.create('div', 'info'); // --> info refers to the CSS style to apply to the new object
  this.update();
  return this._div;
};

// This function updates the DIV when the selected spatial object changes
info.update = function(props) {
  var infoString = '<h4> Información de la ruta </h4>';
  for (var item in props) {
      infoString += '<b>' + item + '</b> ' + props[item] + '</b> <br />';
  }

  this._div.innerHTML = infoString;
};
